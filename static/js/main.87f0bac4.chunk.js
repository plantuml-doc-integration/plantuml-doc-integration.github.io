(this["webpackJsonpplantuml-doc-integration"]=this["webpackJsonpplantuml-doc-integration"]||[]).push([[0],{133:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),l=n(15),i=n(16),u=n(18),s=n(17),m=(n(98),n(11)),f=n(20),d=n.n(f),h=n(30),p=n(35),v=n.n(p),E=n(173),g=n(170),y=n(6),w=n(187),b=n(167),C=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e){e.open!==this.props.open&&this.props.open&&this.props.onReset&&this.props.onReset()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(w.a,Object.assign({open:this.props.open},this.props),r.a.createElement(b.a,null,this.props.title),this.props.children))}}]),n}(r.a.Component),k=n(171),x=n(172),O=n(174),A=n(175),j=n(3),I=n(168),_=n(82),D=n(169);function z(e){var t=e.iconClass,n=e.icon,a=e.caption,o=e.children;return r.a.createElement(I.a,null,r.a.createElement("div",{className:Object(j.a)("align-center",t)},n,r.a.createElement(_.a,{variant:"h5"},a)),r.a.createElement(D.a,null,o))}var S=function(e,t){return{store:function(n){e.setItem(t,JSON.stringify(n))},load:function(){var n=e.getItem(t);return null===n?null:JSON.parse(n)},clear:function(){e.removeItem(t)},exists:function(){return null!==e.getItem(t)}}},T=S(localStorage,"plantuml-doc-integration-token-v1"),N=S(localStorage,"plantuml-doc-integration-redirect-docid");function U(){return W.apply(this,arguments)}function W(){return(W=Object(h.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,e.prev=1,e.next=4,v.a.get("/auth/new");case 4:200===(n=e.sent).status?window.location.href=n.data.authUrl:t=!1,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),t=!1;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var L=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,fail:!1,authorized:!1},e.unauthorize=function(){T.clear(),N.clear(),e.props.onClose()},e.authorize=Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({loading:!0,fail:!1},Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:t.sent||e.setState({loading:!0,fail:!0});case 4:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(n,[{key:"reset",value:function(){this.setState({loading:!1,fail:!1,authorized:T.exists()})}},{key:"render",value:function(){var e=this;return r.a.createElement(C,{open:this.props.open,onClose:function(){return e.props.onClose()},onReset:function(){return e.reset()},title:"Authorization"},r.a.createElement(y.If,{condition:this.state.loading},r.a.createElement(y.Then,null,r.a.createElement(y.If,{condition:this.state.fail},r.a.createElement(y.Then,null,r.a.createElement(z,{iconClass:"color-danger",icon:r.a.createElement(g.a,{className:"large-icon"}),caption:"Failed to connect"},"An error occured when connecting to the server."),r.a.createElement(k.a,null,r.a.createElement(x.a,{color:"primary",onClick:function(){return e.props.onClose()}},"Cancel"),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.authorize()}},"Retry"))),r.a.createElement(y.Else,null,r.a.createElement(z,{icon:r.a.createElement(E.a,{size:"5rem"}),caption:"Please wait..."},"You will be redirected to Google")))),r.a.createElement(y.Else,null,r.a.createElement(y.If,{condition:this.state.authorized},r.a.createElement(y.Then,null,r.a.createElement(z,{iconClass:"color-safe",icon:r.a.createElement(O.a,{className:"large-icon"}),caption:"Authorized"},"You have authorized PlantUML Doc Integration to read your documents on Google Docs. If you wish to remove your authorization token, please click ",r.a.createElement("b",null,"Unauthorize")," below.",r.a.createElement("br",null),r.a.createElement("br",null),"This does not remove permissions for PlantUML Doc Integration. You will need to do that in your Google account settings.")),r.a.createElement(y.Else,null,r.a.createElement(z,{iconClass:"color-danger",icon:r.a.createElement(A.a,{className:"large-icon"}),caption:"Unauthorized"},"You need to authorize PlantUML Doc Integration to read your documents on Google Docs in order to use it. We do not keep your data. We simply parse it and draw diagrams from it.",r.a.createElement("br",null),r.a.createElement("br",null),"You will be automatically asked to authorize this app when you open a document. If you want to authorize it now, click the ",r.a.createElement("b",null,"Authorize")," button below."))),r.a.createElement(k.a,null,r.a.createElement(x.a,{color:"primary",onClick:function(){return e.props.onClose()}},"Cancel"),r.a.createElement(y.If,{condition:this.state.authorized},r.a.createElement(y.Then,null,r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.unauthorize()}},"Unauthorize")),r.a.createElement(y.Else,null,r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.authorize()}}," Authorize")))))))}}]),n}(r.a.Component),P=n(177),M=n(178),R=n(188),G=n(135),H=n(179),Y=n(180),B=n(185);function J(e){var t=e.children,n=e.label,a=e.value,o=e.onChange,c=e.error;return r.a.createElement(I.a,null,r.a.createElement(D.a,null,t),r.a.createElement(B.a,{margin:"normal",autoFocus:!0,label:n,value:a,onChange:function(e){return o(e.target.value)},error:!!c,helperText:c||" ",required:!0,fullWidth:!0}))}var F=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={input:"",error:""},e}return Object(i.a)(n,[{key:"reset",value:function(){this.setState({input:"",error:""})}},{key:"onChangeInput",value:function(e){this.setState({input:e,error:""})}},{key:"onClickClose",value:function(e){e?this.validateInput(this.state.input)&&this.props.onClose(this.processInput(this.state.input)):this.props.onClose(!1)}},{key:"validateInput",value:function(e){return!!e||(this.setState({error:"This is required"}),!1)}},{key:"processInput",value:function(e){var t="https://docs.google.com/document/d/";if(e.startsWith(t)){var n=(e=e.substring(t.length)).indexOf("/");n>0&&(e=e.substring(0,n))}return e}},{key:"render",value:function(){var e=this;return r.a.createElement(C,{fullWidth:!0,open:this.props.open,title:"Open from Google Docs",onReset:function(){return e.reset()}},r.a.createElement(J,{label:"Document Link/Id",value:this.state.input,onChange:function(t){return e.onChangeInput(t)},error:this.state.error},"Please enter the document link or id"),r.a.createElement(k.a,null,r.a.createElement(x.a,{color:"primary",onClick:function(){return e.onClickClose(!1)}},"Cancel"),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.onClickClose(!0)}},"Open")))}}]),n}(r.a.Component),q=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={openAuthorizeDialog:!1,openOpenDocumentDialog:!1},e}return Object(i.a)(n,[{key:"setOpenDocument",value:function(e){this.setState({openOpenDocumentDialog:!1}),e&&this.props.history.push("/docs/".concat(e))}},{key:"render",value:function(){var e=this;return r.a.createElement("header",null,r.a.createElement(P.a,{position:"static"},r.a.createElement(M.a,null,r.a.createElement(R.a,{title:"Open Document"},r.a.createElement(G.a,{edge:"start",color:"inherit",onClick:function(){return e.setState({openOpenDocumentDialog:!0})}},r.a.createElement(H.a,{className:"header-icon"}))),r.a.createElement(_.a,{variant:"h5"},this.props.title),r.a.createElement("div",{className:"toolbar-align-right"},r.a.createElement(R.a,{title:"Authorization"},r.a.createElement(G.a,{edge:"start",color:"inherit",onClick:function(){return e.setState({openAuthorizeDialog:!0})}},r.a.createElement(Y.a,{className:"header-icon"})))))),r.a.createElement(F,{open:this.state.openOpenDocumentDialog,onClose:function(t){return e.setOpenDocument(t)}}),r.a.createElement(L,{open:this.state.openAuthorizeDialog,onClose:function(){return e.setState({openAuthorizeDialog:!1})}}))}}]),n}(r.a.Component),$=Object(m.f)(q),K=n(189),Q=n(181),V=n(183),X=n(182);function Z(e){var t=e.src,n=e.title;return r.a.createElement("div",null,r.a.createElement("img",{alt:n||"Plant UML Diagram",src:t,width:"100%"}),";")}function ee(e){var t=e.valid,n=e.data,a=e.src,o=e.id;return r.a.createElement(K.a,null,r.a.createElement(Q.a,{expandIcon:r.a.createElement(X.a,null),"aria-controls":"diagram".concat(o,"-content"),id:"diagram".concat(o,"-header")},r.a.createElement(y.If,{condition:t},r.a.createElement(y.Then,null,r.a.createElement(_.a,{variant:"h6"},n.title?n.title:"Untitled")),r.a.createElement(y.Else,null,r.a.createElement(_.a,{variant:"h6"},"Invalid Diagram")))),r.a.createElement(y.When,{condition:t},r.a.createElement(V.a,null,r.a.createElement(Z,{src:a,title:n.title}))))}var te=function(){var e,t,n,a,r,o,c,l,i,u,s,m,f,d,h,p,v,E,g,y,w,b,C,k,x,O,A,j,I,_,D,z,S,T,N,U,W,L,P,M,R,G,H,Y,B,J,F,q,$,K,Q,V,X,Z,ee,te=parseInt(5),ne=null;function ae(){this.fc=0,this.dl=0}function re(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function oe(e,t,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=a}function ce(){this.next=null,this.len=0,this.ptr=new Array(8192),this.off=0}var le=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ie=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[new oe(0,0,0,0),new oe(4,4,8,4),new oe(4,5,16,8),new oe(4,6,32,32),new oe(4,4,16,16),new oe(8,16,32,32),new oe(8,16,128,128),new oe(8,32,128,256),new oe(32,128,258,1024),new oe(32,258,258,4096)];function fe(t){t.next=e,e=t}function de(e){return s[32768+e]}function he(e,t){return s[32768+e]=t}function pe(a){ne[o+r++]=a,o+r==8192&&function(){if(0!=r){var a,c;for(a=function(){var t;return null!=e?(t=e,e=e.next):t=new ce,t.next=null,t.len=t.off=0,t}(),null==t?t=n=a:n=n.next=a,a.len=r-o,c=0;c<a.len;c++)a.ptr[c]=ne[o+c];r=o=0}}()}function ve(e){e&=65535,o+r<8190?(ne[o+r++]=255&e,ne[o+r++]=e>>>8):(pe(255&e),pe(e>>>8))}function Ee(){h=8191&(h<<te^255&l[w+3-1]),p=de(h),s[32767&w]=p,he(h,w)}function ge(e,t){We(t[e].fc,t[e].dl)}function ye(e){return 255&(e<256?H[e]:H[256+(e>>7)])}function we(e,t,n){return e[t].fc<e[n].fc||e[t].fc==e[n].fc&&R[t]<=R[n]}function be(e,t,n){var a;for(a=0;a<n&&ee<Z.length;a++)e[t+a]=255&Z.charCodeAt(ee++);return a}function Ce(e){var t,n,a=x,r=w,o=y,c=w>32506?w-32506:0,i=w+258,u=l[r+o-1],m=l[r+o];y>=j&&(a>>=2);do{if(l[(t=e)+o]==m&&l[t+o-1]==u&&l[t]==l[r]&&l[++t]==l[r+1]){r+=2,t++;do{}while(l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&l[++r]==l[++t]&&r<i);if(n=258-(i-r),r=i-258,n>o){if(b=e,o=n,n>=258)break;u=l[r+o-1],m=l[r+o]}}}while((e=s[32767&e])>c&&0!=--a);return o}function ke(){var e,t,n=65536-k-w;if(-1==n)n--;else if(w>=65274){for(e=0;e<32768;e++)l[e]=l[e+32768];for(b-=32768,w-=32768,d-=32768,e=0;e<8192;e++)he(e,(t=de(e))>=32768?t-32768:0);for(e=0;e<32768;e++)t=s[e],s[e]=t>=32768?t-32768:0;n+=32768}C||((e=be(l,w+k,n))<=0?C=!0:k+=e)}function xe(){C||(m=0,f=0,function(){var e,t,n,a,r;if(0!=z[0].dl)return;for(T.dyn_tree=I,T.static_tree=D,T.extra_bits=le,T.extra_base=257,T.elems=286,T.max_length=15,T.max_code=0,N.dyn_tree=_,N.static_tree=z,N.extra_bits=ie,N.extra_base=0,N.elems=30,N.max_length=15,N.max_code=0,U.dyn_tree=S,U.static_tree=null,U.extra_bits=ue,U.extra_base=0,U.elems=19,U.max_length=7,U.max_code=0,n=0,a=0;a<28;a++)for(Y[a]=n,e=0;e<1<<le[a];e++)G[n++]=a;for(G[n-1]=a,r=0,a=0;a<16;a++)for(B[a]=r,e=0;e<1<<ie[a];e++)H[r++]=a;for(r>>=7;a<30;a++)for(B[a]=r<<7,e=0;e<1<<ie[a]-7;e++)H[256+r++]=a;for(t=0;t<=15;t++)W[t]=0;e=0;for(;e<=143;)D[e++].dl=8,W[8]++;for(;e<=255;)D[e++].dl=9,W[9]++;for(;e<=279;)D[e++].dl=7,W[7]++;for(;e<=287;)D[e++].dl=8,W[8]++;for(_e(D,287),e=0;e<30;e++)z[e].dl=5,z[e].fc=Le(e,5);je()}(),function(){var e;for(e=0;e<8192;e++)s[32768+e]=0;if(O=me[A].max_lazy,j=me[A].good_length,x=me[A].max_chain,w=0,d=0,(k=be(l,0,65536))<=0)return C=!0,void(k=0);for(C=!1;k<262&&!C;)ke();for(h=0,e=0;e<2;e++)h=8191&(h<<te^255&l[e])}(),t=null,r=0,o=0,A<=3?(y=2,g=0):(g=2,E=0),c=!1)}function Oe(e,n,r){var o;return a||(xe(),a=!0,0!=k)?(o=Ae(e,n,r))==r?r:c?o:(A<=3?function(){for(;0!=k&&null==t;){var e;if(Ee(),0!=p&&w-p<=32506&&(g=Ce(p))>k&&(g=k),g>=3)if(e=Ne(w-b,g-3),k-=g,g<=O){g--;do{w++,Ee()}while(0!=--g);w++}else w+=g,g=0,h=8191&((h=255&l[w])<<te^255&l[w+1]);else e=Ne(0,255&l[w]),k--,w++;for(e&&(Te(0),d=w);k<262&&!C;)ke()}}():function(){for(;0!=k&&null==t;){if(Ee(),y=g,v=b,g=2,0!=p&&y<O&&w-p<=32506&&((g=Ce(p))>k&&(g=k),3==g&&w-b>4096&&g--),y>=3&&g<=y){var e;e=Ne(w-1-v,y-3),k-=y-1,y-=2;do{w++,Ee()}while(0!=--y);E=0,g=2,w++,e&&(Te(0),d=w)}else 0!=E?(Ne(0,255&l[w-1])&&(Te(0),d=w),w++,k--):(E=1,w++,k--);for(;k<262&&!C;)ke()}}(),0==k&&(0!=E&&Ne(0,255&l[w-1]),Te(1),c=!0),o+Ae(e,o+n,r-o)):(c=!0,0)}function Ae(e,n,a){var c,l,i;for(c=0;null!=t&&c<a;){for((l=a-c)>t.len&&(l=t.len),i=0;i<l;i++)e[n+c+i]=t.ptr[t.off+i];var u;if(t.off+=l,t.len-=l,c+=l,0==t.len)u=t,t=t.next,fe(u)}if(c==a)return c;if(o<r){for((l=a-c)>r-o&&(l=r-o),i=0;i<l;i++)e[n+c+i]=ne[o+i];c+=l,r==(o+=l)&&(r=o=0)}return c}function je(){var e;for(e=0;e<286;e++)I[e].fc=0;for(e=0;e<30;e++)_[e].fc=0;for(e=0;e<19;e++)S[e].fc=0;I[256].fc=1,V=X=0,F=q=$=0,K=0,Q=1}function Ie(e,t){for(var n=L[t],a=t<<1;a<=P&&(a<P&&we(e,L[a+1],L[a])&&a++,!we(e,n,L[a]));)L[t]=L[a],t=a,a<<=1;L[t]=n}function _e(e,t){var n,a,r=new Array(16),o=0;for(n=1;n<=15;n++)o=o+W[n-1]<<1,r[n]=o;for(a=0;a<=t;a++){var c=e[a].dl;0!=c&&(e[a].fc=Le(r[c]++,c))}}function De(e){var t,n,a=e.dyn_tree,r=e.static_tree,o=e.elems,c=-1,l=o;for(P=0,M=573,t=0;t<o;t++)0!=a[t].fc?(L[++P]=c=t,R[t]=0):a[t].dl=0;for(;P<2;){var i=L[++P]=c<2?++c:0;a[i].fc=1,R[i]=0,V--,null!=r&&(X-=r[i].dl)}for(e.max_code=c,t=P>>1;t>=1;t--)Ie(a,t);do{t=L[1],L[1]=L[P--],Ie(a,1),n=L[1],L[--M]=t,L[--M]=n,a[l].fc=a[t].fc+a[n].fc,R[t]>R[n]+1?R[l]=R[t]:R[l]=R[n]+1,a[t].dl=a[n].dl=l,L[1]=l++,Ie(a,1)}while(P>=2);L[--M]=L[1],function(e){var t,n,a,r,o,c,l=e.dyn_tree,i=e.extra_bits,u=e.extra_base,s=e.max_code,m=e.max_length,f=e.static_tree,d=0;for(r=0;r<=15;r++)W[r]=0;for(l[L[M]].dl=0,t=M+1;t<573;t++)(r=l[l[n=L[t]].dl].dl+1)>m&&(r=m,d++),l[n].dl=r,n>s||(W[r]++,o=0,n>=u&&(o=i[n-u]),c=l[n].fc,V+=c*(r+o),null!=f&&(X+=c*(f[n].dl+o)));if(0!=d){do{for(r=m-1;0==W[r];)r--;W[r]--,W[r+1]+=2,W[m]--,d-=2}while(d>0);for(r=m;0!=r;r--)for(n=W[r];0!=n;)(a=L[--t])>s||(l[a].dl!=r&&(V+=(r-l[a].dl)*l[a].fc,l[a].fc=r),n--)}}(e),_e(a,c)}function ze(e,t){var n,a,r=-1,o=e[0].dl,c=0,l=7,i=4;for(0==o&&(l=138,i=3),e[t+1].dl=65535,n=0;n<=t;n++)a=o,o=e[n+1].dl,++c<l&&a==o||(c<i?S[a].fc+=c:0!=a?(a!=r&&S[a].fc++,S[16].fc++):c<=10?S[17].fc++:S[18].fc++,c=0,r=a,0==o?(l=138,i=3):a==o?(l=6,i=3):(l=7,i=4))}function Se(e,t){var n,a,r=-1,o=e[0].dl,c=0,l=7,i=4;for(0==o&&(l=138,i=3),n=0;n<=t;n++)if(a=o,o=e[n+1].dl,!(++c<l&&a==o)){if(c<i)do{ge(a,S)}while(0!=--c);else 0!=a?(a!=r&&(ge(a,S),c--),ge(16,S),We(c-3,2)):c<=10?(ge(17,S),We(c-3,3)):(ge(18,S),We(c-11,7));c=0,r=a,0==o?(l=138,i=3):a==o?(l=6,i=3):(l=7,i=4)}}function Te(e){var t,n,a,r,o;if(r=w-d,J[$]=K,De(T),De(N),a=function(){var e;for(ze(I,T.max_code),ze(_,N.max_code),De(U),e=18;e>=3&&0==S[se[e]].dl;e--);return V+=3*(e+1)+5+5+4,e}(),(n=X+3+7>>3)<=(t=V+3+7>>3)&&(t=n),r+4<=t&&d>=0)for(We(0+e,3),Pe(),ve(r),ve(~r),o=0;o<r;o++)pe(l[d+o]);else n==t?(We(2+e,3),Ue(D,z)):(We(4+e,3),function(e,t,n){var a;for(We(e-257,5),We(t-1,5),We(n-4,4),a=0;a<n;a++)We(S[se[a]].dl,3);Se(I,e-1),Se(_,t-1)}(T.max_code+1,N.max_code+1,a+1),Ue(I,_));je(),0!=e&&Pe()}function Ne(e,t){if(u[F++]=t,0==e?I[t].fc++:(e--,I[G[t]+256+1].fc++,_[ye(e)].fc++,i[q++]=e,K|=Q),Q<<=1,0==(7&F)&&(J[$++]=K,K=0,Q=1),A>2&&0==(4095&F)){var n,a=8*F,r=w-d;for(n=0;n<30;n++)a+=_[n].fc*(5+ie[n]);if(a>>=3,q<parseInt(F/2)&&a<parseInt(r/2))return!0}return 8191==F||8192==q}function Ue(e,t){var n,a,r,o,c=0,l=0,s=0,m=0;if(0!=F)do{0==(7&c)&&(m=J[s++]),a=255&u[c++],0==(1&m)?ge(a,e):(ge((r=G[a])+256+1,e),0!=(o=le[r])&&We(a-=Y[r],o),ge(r=ye(n=i[l++]),t),0!=(o=ie[r])&&We(n-=B[r],o)),m>>=1}while(c<F);ge(256,e)}function We(e,t){f>16-t?(ve(m|=e<<f),m=e>>16-f,f+=t-16):(m|=e<<f,f+=t)}function Le(e,t){var n=0;do{n|=1&e,e>>=1,n<<=1}while(--t>0);return n>>1}function Pe(){f>8?ve(m):f>0&&pe(m),m=0,f=0}return function(r,o){var c,m;Z=r,ee=0,"undefined"==typeof o&&(o=6),function(r){var o;if(r?r<1?r=1:r>9&&(r=9):r=6,A=r,a=!1,C=!1,null==ne){for(e=t=n=null,ne=new Array(8192),l=new Array(65536),i=new Array(8192),u=new Array(32832),s=new Array(65536),I=new Array(573),o=0;o<573;o++)I[o]=new ae;for(_=new Array(61),o=0;o<61;o++)_[o]=new ae;for(D=new Array(288),o=0;o<288;o++)D[o]=new ae;for(z=new Array(30),o=0;o<30;o++)z[o]=new ae;for(S=new Array(39),o=0;o<39;o++)S[o]=new ae;T=new re,N=new re,U=new re,W=new Array(16),L=new Array(573),R=new Array(573),G=new Array(256),H=new Array(512),Y=new Array(29),B=new Array(30),J=new Array(parseInt(1024))}}(o);for(var f=new Array(1024),d=[];(c=Oe(f,0,f.length))>0;){var h=new Array(c);for(m=0;m<c;m++)h[m]=String.fromCharCode(f[m]);d[d.length]=h.join("")}return Z=null,d.join("")}}(),ne=function(e,t,n){var a=(3&e)<<4|t>>4,r=(15&t)<<2|n>>6,o=63&n,c="";return c+=ae(63&e>>2),c+=ae(63&a),c+=ae(63&r),c+=ae(63&o)},ae=function(e){return e<10?String.fromCharCode(48+e):(e-=10)<26?String.fromCharCode(65+e):(e-=26)<26?String.fromCharCode(97+e):0==(e-=26)?"-":1==e?"_":"?"};function re(e){var t=unescape(encodeURIComponent(e));return"http://www.plantuml.com/plantuml/img/"+function(e){for(var t="",n=0;n<e.length;n+=3)n+2==e.length?t+=ne(e.charCodeAt(n),e.charCodeAt(n+1),0):n+1==e.length?t+=ne(e.charCodeAt(n),0,0):t+=ne(e.charCodeAt(n),e.charCodeAt(n+1),e.charCodeAt(n+2));return t}(te(t,9))}var oe={addTitle:!1};function ce(e,t){var n=(t||oe).addTitle,a=e.indexOf("@startuml");if(a<0)return{valid:!1};var r=e.substring(0,a),o=e.substring(a+"@startuml".length),c=r.split("\n"),l={};c.forEach((function(e){if((e=e.trim()).startsWith("@")){var t=e.indexOf(" ");if(t<0){var n=e.substring(1);l[n]=!0}else{var a=e.substring(1,t).trim(),r=e.substring(t).trim();l[a]=r}}})),n&&l.title&&(o="TITLE "+l.title+"\n"+o),console.log(l);var i=re(o);return{valid:!0,data:l,src:i}}var le=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,error:!1,document:void 0},e.loadDocument=Object(h.a)(d.a.mark((function t(){var n,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0,error:!1,document:void 0}),t.prev=1,t.next=4,v.a.get("/docs/".concat(e.props.match.params.docId),{headers:{authorization:"bearer ".concat(T.load())}});case 4:200===(n=t.sent).status?(console.log(n),a={title:n.data.title,documentId:n.data.documentId,diagrams:n.data.rawData.map(ce)},console.log(a.diagrams),e.setState({document:a,loading:!1,error:!1})):(console.log(n),e.setState({error:!0,loading:!1,document:void 0})),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),t.t0.response&&401===t.t0.response.status&&T.clear(),console.log(t.t0),e.setState({error:!0,loading:!1,document:void 0});case 13:case"end":return t.stop()}}),t,null,[[1,8]])}))),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateDocument()}},{key:"componentDidUpdate",value:function(e){this.props.match.params.docId!==e.match.params.docId&&this.updateDocument()}},{key:"updateDocument",value:function(){var e=this.props.match.params.docId;e?(N.store(e),T.exists()&&this.loadDocument()):this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=T.exists();return r.a.createElement("div",null,r.a.createElement($,{title:this.state.loading?"Loading Title...":this.state.error?"Error":this.state.document?this.state.document.title:"Unknown Document"}),r.a.createElement(L,{open:!t,onClose:function(){return e.props.history.push("/")}}),r.a.createElement(y.If,{condition:this.state.loading},r.a.createElement(y.Then,null,r.a.createElement(E.a,null),"Loading"),r.a.createElement(y.Else,null,r.a.createElement(y.If,{condition:this.state.error},r.a.createElement(y.Then,null,r.a.createElement(g.a,null),"Error"),r.a.createElement(y.Else,null,r.a.createElement(y.When,{condition:!!this.state.document},(function(){return r.a.createElement(y.If,{condition:0===e.state.document.diagrams.filter((function(e){return e.valid})).length},r.a.createElement(y.Then,null,"No Diagram"),r.a.createElement(y.Else,null,r.a.createElement("div",{className:"page"},e.state.document.diagrams.map((function(e,t){return r.a.createElement(ee,Object.assign({key:t,id:t},e))})))))})))))))}}]),n}(r.a.Component),ie=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement($,{title:"Home"}),"Home page working in progress")}}]),n}(r.a.Component),ue=n(184),se=n(80),me=n.n(se),fe=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,success:!1,retry:!1,proceed:!1},e.verifyCode=function(){var t=Object(h.a)(d.a.mark((function t(n){var a,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=!1,t.prev=1,t.next=4,v.a.get("/auth/token",{params:{code:n}});case 4:200===(r=t.sent).status&&(a=!0,T.store(r.data.token)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:e.setState({success:a,loading:!1});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}(),e.retryAuthorize=function(){e.setState({loading:!0,success:!1,proceed:!1,retry:!0},Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:e.setState({loading:!1,success:!1});case 3:case"end":return t.stop()}}),t)}))))},e.redirectHome=function(){e.props.history.push("/")},e.redirectDocs=function(){N.exists()?e.props.history.push("/docs/".concat(N.load())):e.props.history.push("/")},e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){T.exists()&&this.props.history.push("/");var e=me.a.parse(this.props.location.search).code;e?(N.exists()&&this.setState({proceed:!0}),this.setState({retry:!1}),this.verifyCode(e)):this.setState({loading:!1,success:!1,proceed:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement($,{title:"Authorization"}),r.a.createElement(C,{open:!0,onClose:function(){return e.redirectHome()},title:"Authorization"},r.a.createElement(y.If,{condition:this.state.loading},r.a.createElement(y.Then,null,r.a.createElement(y.If,{condition:this.state.retry},r.a.createElement(y.Then,null,r.a.createElement(z,{icon:r.a.createElement(E.a,{size:"5rem"}),caption:"Please wait..."},"You will be redirected to Google")),r.a.createElement(y.Else,null,r.a.createElement(z,{icon:r.a.createElement(E.a,{size:"5rem"}),caption:"Just A Moment..."},"We are getting your response from Google")))),r.a.createElement(y.Else,null,r.a.createElement(y.If,{condition:this.state.success},r.a.createElement(y.Then,null,r.a.createElement(z,{iconClass:"color-safe",icon:r.a.createElement(ue.a,{className:"large-icon"}),caption:"Success!"},"All Done! You can start viewing your diagrams now.",r.a.createElement(y.When,{condition:this.state.proceed},r.a.createElement("br",null),"Click ",r.a.createElement("b",null,"Proceed")," to view the diagrams in your document")),r.a.createElement(k.a,null,r.a.createElement(y.If,{condition:this.state.proceed},r.a.createElement(y.Then,null,r.a.createElement(x.a,{color:"primary",onClick:function(){return e.redirectHome()}},"Back"),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.redirectDocs()}},"Proceed")),r.a.createElement(y.Else,null,r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.redirectHome()}},"Done"))))),r.a.createElement(y.Else,null,r.a.createElement(z,{iconClass:" color-danger",icon:r.a.createElement(g.a,{className:"large-icon"}),caption:"Failed to authorize"},"An error occured. Click ",r.a.createElement("b",null,"Retry")," to try again."),r.a.createElement(k.a,null,r.a.createElement(x.a,{color:"primary",onClick:function(){return e.redirectHome()}},"Back"),r.a.createElement(x.a,{variant:"contained",color:"primary",onClick:function(){return e.retryAuthorize()}},"Retry"))))))))}}]),n}(r.a.Component);function de(){return r.a.createElement("footer",null,r.a.createElement(_.a,{variant:"caption",className:"text-light"},"PlantUML Doc Integration 2020"))}var he=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"main-content"},r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/docs/:docId",component:le}),r.a.createElement(m.a,{path:"/auth",component:fe}),r.a.createElement(m.a,{exact:!0,path:"/"},r.a.createElement(ie,null)),r.a.createElement(m.a,{path:"*"},"Not Found")),r.a.createElement(de,null))}}]),n}(r.a.Component),pe=Object(m.f)(he),ve=n(48);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));v.a.defaults.baseURL=Ee?"http://localhost:5000":"https://plantuml-doc-integration-api.herokuapp.com",c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ve.a,null,r.a.createElement(pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},93:function(e,t,n){e.exports=n(133)},98:function(e,t,n){}},[[93,1,2]]]);
//# sourceMappingURL=main.87f0bac4.chunk.js.map